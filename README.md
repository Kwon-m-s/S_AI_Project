S_AI_Project
=
Overview
![Overview](https://github.com/user-attachments/assets/f23fb8dd-9f08-456c-b15d-53c1402624b0)
=
프로젝트 목표  
--
피부 병변의 이미지를 분석하여 피부암(예: 흑색종)을 자동으로 탐지하고 진단하는 AI 모델을 개발합니다. Convolutional Neural Network(CNN)와 같은 딥러닝 모델을 사용하여 피부 병변의 유형을 분류하고, 이를 통해 조기 진단을 지원합니다.

[http://127.0.0.1:5000/](https://fcdb-203-237-200-12.ngrok-free.app/) 테스트 주소

필요 도구 및 기술
--
* Python: 주 프로그래밍 언어 

* TensorFlow: 딥러닝 모델 개발

* Keras: 딥러닝 라이브러리 (TensorFlow와 연동)

* colab Notebook: 데이터 분석 및 모델 학습 실험

* flask: 로컬 서버 구축

단계별 구현 계획
--
1. 데이터 수집 및 전처리
  
    데이터셋: https://www.kaggle.com/datasets/fanconic/skin-cancer-malignant-vs-benign
    * 공개된 피부암 이미지 데이터셋(Kaggle 데이터셋)을 사용합니다. 이 데이터셋은 다양한 피부 병변 이미지와 그에 따른 진단 레이블을 포함
    
    데이터 전처리:

    +	이미지 크기 조정: 이미지를 일정한 크기로 리사이징하여 모델 입력으로 사용합니다.
    
    +	정규화: 픽셀 값을 0~1 사이로 정규화하여 모델 학습을 돕습니다.

    +	데이터 증강: fine tuning를 이용한 회전, 플립, 밝기 조절, 노이즈 추가 등 다양한 데이터 증강 기법을 적용하여 모델의 일반화 능력을 향상.
      
2. 모델 설계
   
  	CNN 기반의 이미지 분류 모델:

    +	CNN 모델: Convolutional Neural Network를 사용하여 이미지를 분류합니다. VGG16을 사용하여 학습
    + 모델 구조: Conv2D 레이어를 통해 특징을 추출, Fully Connected 레이어를 통해 분류. 마지막 sigmoid 레이어를 통해 각 클래스(예: 양성, 악성)에 대한 확률을 출력합니다.

  	전이 학습: 
    + ImageNet 데이터셋에서 사전 학습된 모델을 사용하여 초기 가중치를 설정하고, 피부 병변 데이터에 맞게 미세 조정을 수행.

3. 모델 훈련
   
    훈련 및 검증 데이터 분리: 
    * 데이터를 훈련 세트와 검증 세트로 나누어 모델을 훈련시킵니다.

    손실 함수: 
    * Cross-Entropy Loss를 사용하여 모델의 예측 오류를 최소화합니다.

    최적화 기법:  
    * Adam을 사용하여 모델을 최적화합니다.

    조기 종료 및 모델 저장: 
    * 검증 손실이 더 이상 감소하지 않을 때 학습을 조기 종료하고, 최적의 모델을 저장합니다.

4. 모델 평가 및 테스트
   
    성능 평가 지표:
    * 정확도(Accuracy): 전체 샘플 중 올바르게 분류된 샘플의 비율을 측정합니다.
    
    시각적 평가: 
    * 예측된 분류 결과를 시각화하여 모델의 예측이 얼마나 정확한지 육안으로 평가.
    * 학습하는 과정을 그래프로 만들어 모델의 성장률을 평가

5. 모델 최적화 및 튜닝
    
    하이퍼파라미터 튜닝: 
    * 학습률, 배치 크기, 네트워크 깊이 등의 하이퍼파라미터를 조정하여 모델 성능을 최적화합니다.
    
    데이터 증강 기법 확장: 
    * 더 다양한 증강 기법을 적용하여 모델의 일반화 능력을 강화합니다.


결과 분석 및 결론 도출
--
  모델 성능 분석: 
  * 분류 모델 레이어를 더 세분화하여 쌓아 올린 정확도는 실 사용과정에서 오류가 더 자주 발생.
  * 전의 학습을 통한 모델 생성으로, 레이어를 세분화하여 쌓아올린 첫 모델보다 정확도는 떨어지지만 실 사용 과정에서 더 잘못 판단하는 경우가 적고 더 좋은 결과를 양성함.

  결론: 
  * 학습한 모델의 데이터 셋이 명확하게 구분이 가능한 고양이와 개를 비교하는 데이터 셋의 경우 레이어를 쌓아올려 정확도를 높여도 작동 오류가 적지만, 피부암 판별과 같이 피부암 의심사진과 피부암 비교처럼 구분이 어려울 경우 전이 학습을 시킨 모델이 더 우수하다는 결론이 도출.
  * 실제 피부암을 판별하기에 심각한 피부암 정도는 판별가능하지만,초기 피부암과 같이 피부와 유사한 경우 아직 판별이 미흡하다는 문제점이 발생 이 부분을 보완 할 필요가 있다.

프로젝트 확장 아이디어:
--
  자가진단 챗봇 개발: 
  * 진단 시스템을 실제 사용자가 활용할 수 있도록 모바일이나 웹 챗봇으로 구현.
  * 피부암 외의 다른 피부질환도 진단.

1일차
--
  CNN 기반 모델 학습, 머신러닝한 모델 기반으로 피부병 자가진단 웹 제작
  * 발생 오류
    + 학습한 데이터 외 사진을 업로드 할 경우 판별하지 못하는 오류가 발생 2일차에 수정 예정
    + 머신러닝 모델 정확도가 부족함 0.85정도 0.90 이상으로 업그레이드 필요

2일차
--
 * 1일차에 발생한 피부 외 사진 업로드시 판별하는 모델 학습, 학습시킨 모델을 적용해 1차로 피부 판별 2차 모델로 피부암 판별하는 구조를 구성.
 * CNN기반 레이어를 증설해 모델을 학습시키는 과정에선 결과가 0.95의 근접하게 성장했지만 학습기반 모델을 사용해 웹을 구성했을 때 실제 정확도가 떨어지는 경우가 발생했다. 이에 따라 모델을 전이 학습을 시키고 정확도를 더 
  높게하기위해 Fine-Tuning 기술을 사용해 더 세분화 하여 학습시키는 과정을 진행했다. 이에 따른 결과는 0.88정도의 정확도로 미미했지만 실제 모델을 사용해 구현했을 경우 오류가 더 적고 성공적인 결과물을 생성했다.
 * 머신러닝 모델이 학습한 데이터셋이 일반피부와 피부암을 구분하는 것이 아닌 상처 및 아토피등 피부질병과 피부암을 비교해 분석하는 모델인 만큼 정확도가 떨어진다는 결과.
 * UI 디자인 변경 출력 결과 위험군이면 안내 문구 추가.

